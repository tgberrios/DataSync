PROMPT PARA IMPLEMENTAR SISTEMA DE DELTAS
Necesito que implementes el mismo sistema de sincronizaciÃ³n delta que funciona en MariaDBToPostgres.h y catalog_manager.h en los siguientes archivos:
MongoToPostgres.h
MSSQLToPostgres.h
PostgresToPostgres.h
ðŸŽ¯ FUNCIONALIDADES A IMPLEMENTAR
âœ… DELETES por Primary Key:
FunciÃ³n processDeletesByPrimaryKey() que detecta registros eliminados
Compara Primary Keys entre fuente y destino
Elimina registros que ya no existen en la fuente
Procesamiento en batches para eficiencia
âœ… UPDATES por Primary Key:
FunciÃ³n processUpdatesByPrimaryKey() que detecta registros modificados
Usa last_sync_column y last_sync_time para detectar cambios
Compara registros y actualiza solo los que cambiaron
FunciÃ³n compareAndUpdateRecord() para comparaciÃ³n inteligente
âœ… INTEGRACIÃ“N EN FLUJO PRINCIPAL:
Modificar la funciÃ³n principal de transferencia de datos
Cuando sourceCount == targetCount: procesar UPDATES
Cuando sourceCount < targetCount: procesar DELETES
Mantener lÃ³gica de INSERTS existente
ðŸ”§ CAMBIOS ESPECÃFICOS REQUERIDOS
1. En catalog_manager.h:
NO sobrescribir last_sync_time con NOW()
Solo actualizar last_sync_column cuando se detecte
Permitir que MariaDBToPostgres.h maneje last_sync_time correctamente
2. En cada archivo de transferencia:
Agregar funciones helper para obtener Primary Keys
Implementar detecciÃ³n de registros eliminados
Implementar detecciÃ³n de registros modificados
Integrar en el flujo principal de transferencia
ï¿½ï¿½ ESTRUCTURA DE FUNCIONES A CREAR
// Para DELETES
void processDeletesByPrimaryKey(...);
std::vector<std::string> getPrimaryKeyColumns(...);
std::vector<std::vector<std::string>> findDeletedPrimaryKeys(...);
size_t deleteRecordsByPrimaryKey(...);

// Para UPDATES  
void processUpdatesByPrimaryKey(...);
bool compareAndUpdateRecord(...);
ðŸŽ¯ OBJETIVO FINAL
Implementar sincronizaciÃ³n delta completa (INSERT + UPDATE + DELETE) en los 3 archivos restantes, siguiendo exactamente el mismo patrÃ³n que ya funciona en MariaDBToPostgres.h.
IMPORTANTE: Mantener la misma lÃ³gica, estructura y flujo que ya estÃ¡ funcionando perfectamente en MariaDBToPostgres.h. No crear nuevas funciones innecesarias, usar las existentes y seguir el principio KISS.



JOB DE AIRFLOW PARA HACERLO DE MONGO EL UPDATE CADA DOMINGO 